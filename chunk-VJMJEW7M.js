import{Aa as f,Ab as S,Ba as I,Fb as y,Ga as c,Ha as d,J as a,O as m,Oa as v,_a as p,ab as l,d as i,gb as C,ja as n,ka as u,wa as g}from"./chunk-DKTJYUJ3.js";import{a as h}from"./chunk-K4ALXBGI.js";var b=(()=>{class e{constructor(){this.isLoading$=new i(!1),this.progress$=new i(0)}start(){this.isLoading$.next(!0),this.progress$.next(0),this.interval=setInterval(()=>{this.progress$.value<90&&this.progress$.next(this.progress$.value+5)},300)}finish(){clearInterval(this.interval),this.progress$.next(100),setTimeout(()=>{this.isLoading$.next(!1)},300)}static{this.\u0275fac=function(s){return new(s||e)}}static{this.\u0275prov=a({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function L(e,$){if(e&1&&(c(0,"div",1)(1,"div",2)(2,"div",3),p(3),d()(),c(4,"p",4),p(5),d()()),e&2){let t=v();n(2),I("width",t.progress,"%"),n(),l(" ",t.progress,"% "),n(2),l("Cargando.... ",t.progress,"%")}}var _=(()=>{class e{constructor(t){this.loaderService=t,this.isLoading=!1,this.progress=0}ngOnInit(){this.loaderService.isLoading$.subscribe(t=>{this.isLoading=t}),this.loaderService.progress$.subscribe(t=>{this.progress=t})}static{this.\u0275fac=function(s){return new(s||e)(u(b))}}static{this.\u0275cmp=m({type:e,selectors:[["app-loader"]],standalone:!0,features:[C],decls:1,vars:1,consts:[["class","loader-overlay",4,"ngIf"],[1,"loader-overlay"],[1,"progress","w-50"],["role","progressbar",1,"progress-bar","progress-bar-striped","progress-bar-animated"],[1,"text-white","mt-2"]],template:function(s,r){s&1&&g(0,L,6,4,"div",0),s&2&&f("ngIf",r.isLoading)},dependencies:[y,S],styles:[".loader-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#000c;display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:9999}.progress[_ngcontent-%COMP%]{height:25px;border-radius:10px;overflow:hidden}"]})}}return e})();var A=(()=>{class e{constructor(){this.cartItems=[],this.cartItemCountSubject=new i(0),this.cartItemCount$=this.cartItemCountSubject.asObservable(),this.scopeKey=this.computeScopeKey(),this.loadCartFromStorage()}computeScopeKey(){let t=sessionStorage.getItem("userInfo");if(!t)return"guest";try{return(JSON.parse(t)?.role??"guest").toLowerCase()}catch{return"guest"}}get CART_KEY(){return`cartItems_${this.scopeKey}`}switchScope(){this.scopeKey=this.computeScopeKey(),this.loadCartFromStorage()}loadCartFromStorage(){let t=sessionStorage.getItem(this.CART_KEY);this.cartItems=t?JSON.parse(t):[],this.updateCount()}saveCartToStorage(){sessionStorage.setItem(this.CART_KEY,JSON.stringify(this.cartItems))}clearCart(){this.cartItems=[],sessionStorage.removeItem(this.CART_KEY),this.updateCount()}clearAllCartsInSession(){Object.keys(sessionStorage).filter(t=>t.startsWith("cartItems_")).forEach(t=>sessionStorage.removeItem(t)),this.cartItems=[],this.updateCount()}getCart(){return[...this.cartItems]}setCart(t){this.cartItems=[...t],this.saveCartToStorage(),this.updateCount()}addToCart(t){let s=t.descripcion?.toLowerCase()||"",r;s.includes("resistencia")&&t.descripcion.includes("1/4 W")||s.includes("led")&&s.includes("diodo")?r=this.cartItems.find(o=>o.id===t.id&&o.descripcion===t.descripcion):r=this.cartItems.find(o=>o.id===t.id),r?r.cantidad+=t.cantidad:this.cartItems.push(h({},t)),this.saveCartToStorage(),this.updateCount()}updateCount(){let t=this.cartItems.length;this.cartItemCountSubject.next(t)}static{this.\u0275fac=function(s){return new(s||e)}}static{this.\u0275prov=a({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();export{A as a,b,_ as c};
