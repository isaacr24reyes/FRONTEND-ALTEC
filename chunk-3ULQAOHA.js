import{v as X,x as a}from"./chunk-AAKDFP5L.js";import{$a as z,Ab as Z,Ca as d,Cb as Y,Ga as P,Ia as U,Ib as K,J as h,Ja as v,K as E,Ka as x,L as g,M as I,O as R,P as D,Qa as M,Ra as F,Sa as G,Va as L,Wa as J,Xa as V,bb as H,e as j,g as O,ja as l,jb as W,ka as m,ma as _,na as A,oa as N,pb as $,ra as B,sb as Q,wa as S}from"./chunk-NXACR2KX.js";import{a as u}from"./chunk-K4ALXBGI.js";var se=["templateOutlet"],re=o=>({active:o});function ae(o,n){if(o&1&&(U(0,"div",7),z(1),v()),o&2){let e=M(2);l(),H(" ",e.message||e.defaultMessage," ")}}function ce(o,n){if(o&1&&(U(0,"div",4),x(1,"div",5),S(2,ae,2,1,"div",6),v()),o&2){let e=M();l(2),d("ngIf",e.message||e.defaultMessage)}}function le(o,n){}function de(o,n){o&1&&S(0,le,0,0,"ng-template",null,0,$)}var pe=["*"],C="block-ui-main",s=(()=>{class o{}return o.START="start",o.STOP="stop",o.UPDATE="update",o.RESET="reset",o.RESET_GLOBAL="reset_global",o.UNSUBSCRIBE="unsubscribe",o})(),f=(()=>{class o{constructor(){this.blockUISettings={},this.blockUIInstances={},this.blockUISubject=new j(1),this.blockUIObservable=this.blockUISubject.asObservable(),this.blockUIObservable.subscribe(this.blockUIMiddleware.bind(this))}getSettings(){return this.blockUISettings}updateSettings(e={}){this.blockUISettings=u(u({},this.blockUISettings),e)}decorate(e=C){let t={name:e,isActive:!1,blockCount:0,start:this.dispatch(this.blockUISubject,s.START,e),update:this.dispatch(this.blockUISubject,s.UPDATE,e),stop:this.dispatch(this.blockUISubject,s.STOP,e),reset:this.dispatch(this.blockUISubject,s.RESET,e),resetGlobal:this.dispatch(this.blockUISubject,s.RESET_GLOBAL,e),unsubscribe:this.dispatch(this.blockUISubject,s.UNSUBSCRIBE,e)};return this.blockUIInstances[e]=this.blockUIInstances[e]||t,t}observe(){return this.blockUIObservable}clearInstance(e){this.dispatch(this.blockUISubject,s.RESET,e)}blockUIMiddleware({action:e,name:t}){let i=null;switch(e){case s.START:i=!0;break;case s.STOP:case s.RESET:i=!1;break}i!==null&&(this.blockUIInstances[t].isActive=i)}dispatch(e,t,i=C){return r=>{e.next({name:i,action:t,message:r})}}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275prov=h({token:o,factory:o.\u0275fac}),o})();var ue=(()=>{class o{constructor(e,t,i){this.blockUI=e,this.resolver=t,this.changeDetectionRef=i,this.name=C,this.defaultBlockState={startTimeouts:[],stopTimeouts:[],updateTimeouts:[],blockCount:0,startCallCount:0,stopCallCount:0},this.state=u({},this.defaultBlockState)}ngOnInit(){this.settings=this.blockUI.getSettings(),this.blockUISubscription=this.subscribeToBlockUI(this.blockUI.observe())}ngAfterViewInit(){try{if(!this.templateCmp)return!1;if(this.templateCmp instanceof _)this.templateOutlet.createEmbeddedView(this.templateCmp);else{let e=this.resolver.resolveComponentFactory(this.templateCmp);this.templateCompRef=this.templateOutlet.createComponent(e),this.updateBlockTemplate(this.message)}}catch(e){console.error("ng-block-ui:",e)}}ngAfterViewChecked(){this.detectChanges()}subscribeToBlockUI(e){return e.subscribe(t=>this.onDispatchedEvent(t))}onDispatchedEvent(e){switch(e.action){case s.START:this.onStart(e);break;case s.STOP:this.onStop(e);break;case s.UPDATE:this.onUpdate(e);break;case s.RESET:this.onReset(e);break;case s.RESET_GLOBAL:this.resetState();break;case s.UNSUBSCRIBE:this.onStop(e),this.onUnsubscribe(e.name);break}}onStart({name:e,message:t}){if(e===this.name){let i=this.delayStart??this.settings.delayStart??0;this.state.startCallCount+=1;let r=setTimeout(()=>{this.state.blockCount+=1,this.showBlock(t),this.updateInstanceBlockCount()},i);this.state.startTimeouts.push(r)}}onStop({name:e}){if(e===this.name){let t=this.state.stopCallCount+1;if(this.state.startCallCount-t>=0){let i=this.delayStop??this.settings.delayStop??0;this.state.stopCallCount=t;let r=setTimeout(()=>{this.state.blockCount-=1,this.updateInstanceBlockCount(),this.detectChanges()},i);this.state.stopTimeouts.push(r)}}}onUpdate({name:e,message:t}){if(e===this.name){let i=this.delayStart||this.settings.delayStart||0;clearTimeout(this.state.updateTimeouts[0]);let r=setTimeout(()=>{this.updateMessage(t)},i);this.state.updateTimeouts.push(r)}}onReset({name:e}){e===this.name&&this.resetState()}updateMessage(e){this.showBlock(e)}showBlock(e){this.message=e||this.defaultMessage||this.settings.message,this.updateBlockTemplate(this.message),this.detectChanges()}updateBlockTemplate(e){this.templateCompRef&&this.templateCompRef instanceof A&&(this.templateCompRef.instance.message=e)}resetState(){[...this.state.startTimeouts,...this.state.stopTimeouts,...this.state.updateTimeouts].forEach(clearTimeout),this.state=u({},this.defaultBlockState),this.updateInstanceBlockCount(),this.detectChanges()}onUnsubscribe(e){this.blockUISubscription&&e===this.name&&this.blockUISubscription.unsubscribe()}updateInstanceBlockCount(){if(this.blockUI.blockUIInstances[this.name]){let{blockCount:e}=this.state;this.blockUI.blockUIInstances[this.name].blockCount=e}}detectChanges(){this.changeDetectionRef.destroyed||this.changeDetectionRef.detectChanges()}ngOnDestroy(){this.resetState(),this.onUnsubscribe(this.name),this.blockUI.clearInstance(this.name)}}return o.\u0275fac=function(e){return new(e||o)(m(f),m(N),m(Q))},o.\u0275cmp=R({type:o,selectors:[["block-ui-content"]],viewQuery:function(e,t){if(e&1&&L(se,5,B),e&2){let i;J(i=V())&&(t.templateOutlet=i.first)}},inputs:{name:"name",delayStart:"delayStart",delayStop:"delayStop",defaultMessage:[0,"message","defaultMessage"],templateCmp:[0,"template","templateCmp"]},decls:3,vars:9,consts:[["templateOutlet",""],[3,"ngClass"],["class","block-ui-spinner",4,"ngIf"],[4,"ngIf"],[1,"block-ui-spinner"],[1,"loader"],["class","message",4,"ngIf"],[1,"message"]],template:function(e,t){e&1&&(U(0,"div",1),S(1,ce,3,1,"div",2)(2,de,2,0,null,3),v()),e&2&&(P("block-ui-wrapper ",t.name," ",t.className,""),d("ngClass",W(7,re,t.state.blockCount>0)),l(),d("ngIf",!t.templateCmp),l(),d("ngIf",t.templateCmp))},dependencies:[Z,Y],styles:[`.block-ui-wrapper{display:none;position:fixed;height:100%;width:100%;top:0;left:0;background:rgba(0,0,0,.7);z-index:30000;cursor:wait}.block-ui-wrapper.block-ui-wrapper--element{position:absolute}.block-ui-wrapper.active{display:block}.block-ui-wrapper.block-ui-main{position:fixed}.block-ui-spinner,.block-ui-template{position:absolute;top:40%;margin:0 auto;left:0;right:0;transform:translateY(-50%)}.block-ui-spinner>.message{font-size:1.3em;text-align:center;color:#fff}.block-ui__element{position:relative}.loader,.loader:after{border-radius:50%;width:10em;height:10em}.loader{margin:7px auto;font-size:5px;position:relative;text-indent:-9999em;border-top:1.1em solid rgba(255,255,255,.2);border-right:1.1em solid rgba(255,255,255,.2);border-bottom:1.1em solid rgba(255,255,255,.2);border-left:1.1em solid #ffffff;transform:translateZ(0);animation:load8 1.1s infinite linear}@keyframes load8{0%{transform:rotate(0)}to{transform:rotate(360deg)}}
`],encapsulation:2}),o})(),_e=(()=>{class o{constructor(e){this.blockUI=e}ngOnInit(){this.name=this.name||C,this.template=this.template||this.blockUI.blockUISettings.template}}return o.\u0275fac=function(e){return new(e||o)(m(f))},o.\u0275cmp=R({type:o,selectors:[["block-ui"]],inputs:{name:"name",message:"message",delayStart:"delayStart",delayStop:"delayStop",template:"template"},ngContentSelectors:pe,decls:2,vars:5,consts:[[3,"name","message","template","delayStart","delayStop"]],template:function(e,t){e&1&&(F(),G(0),x(1,"block-ui-content",0)),e&2&&(l(),d("name",t.name)("message",t.message)("template",t.template)("delayStart",t.delayStart)("delayStop",t.delayStop))},dependencies:[ue],encapsulation:2}),o})(),he=(()=>{class o{constructor(e){this.blockUIInstance=e,this.globalDispatch=this.blockUIInstance.decorate()}start(e,t){this.dispatch(e,s.START,t)}stop(e){this.dispatch(e,s.STOP)}reset(e){this.dispatch(e,s.RESET)}resetGlobal(){this.globalDispatch.resetGlobal()}update(e,t){this.dispatch(e,s.UPDATE,t)}unsubscribe(e){this.dispatch(e,s.UNSUBSCRIBE)}isActive(e=null){let t=e?this.toArray(e):null,i=this.blockUIInstance.blockUIInstances;return Object.keys(i).some(r=>t?t.indexOf(i[r].name)>=0&&i[r].isActive:i[r].isActive)}dispatch(e=[],t,i){this.toArray(e).forEach(p=>this.blockUIInstance.decorate(p)[t](i))}toArray(e=[]){return typeof e=="string"?[e]:e}}return o.\u0275fac=function(e){return new(e||o)(I(f))},o.\u0275prov=h({token:o,factory:o.\u0275fac}),o})();var y=new f,q=new g("BlockUIModuleSettings");function me(o){return y.updateSettings(o),y}var Be=(()=>{class o{static forRoot(e={}){return{ngModule:o,providers:[{provide:q,useValue:e},{provide:f,useFactory:me,deps:[q]},he]}}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=D({type:o}),o.\u0275inj=E({imports:[K]}),o})(),fe=1;function ee(o,n={}){return n.scopeToInstance?function(e,t){let i=`_${t}-block-ui`;Object.defineProperty(e,t,{get:function(){if(this[i])return this[i];let r=`${o}-${fe++}`;return this[i]=y.decorate(r),this[i]},set:function(r){this[i]=r}})}:function(e,t){e[t]=y.decorate(o)}}var b=class o{constructor(){}static get instance(){return this._instance||(this._instance=new o),this._instance}start(n){n||(n=X.loading),this.blockUI.start(n)}stop(){this.blockUI.stop()}};O([ee()],b.prototype,"blockUI",void 0);var be=new g("JWT_OPTIONS"),te=(()=>{class o{constructor(e=null){this.tokenGetter=e&&e.tokenGetter||function(){}}urlBase64Decode(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:{t+="==";break}case 3:{t+="=";break}default:throw new Error("Illegal base64url string!")}return this.b64DecodeUnicode(t)}b64decode(e){let t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i="";if(e=String(e).replace(/=+$/,""),e.length%4===1)throw new Error("'atob' failed: The string to be decoded is not correctly encoded.");for(let r=0,p,c,ie=0;c=e.charAt(ie++);~c&&(p=r%4?p*64+c:c,r++%4)?i+=String.fromCharCode(255&p>>(-2*r&6)):0)c=t.indexOf(c);return i}b64DecodeUnicode(e){return decodeURIComponent(Array.prototype.map.call(this.b64decode(e),t=>"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)).join(""))}decodeToken(e=this.tokenGetter()){return e instanceof Promise?e.then(t=>this._decodeToken(t)):this._decodeToken(e)}_decodeToken(e){if(!e||e==="")return null;let t=e.split(".");if(t.length!==3)throw new Error("The inspected token doesn't appear to be a JWT. Check to make sure it has three parts and see https://jwt.io for more.");let i=this.urlBase64Decode(t[1]);if(!i)throw new Error("Cannot decode the token.");return JSON.parse(i)}getTokenExpirationDate(e=this.tokenGetter()){return e instanceof Promise?e.then(t=>this._getTokenExpirationDate(t)):this._getTokenExpirationDate(e)}_getTokenExpirationDate(e){let t;if(t=this.decodeToken(e),!t||!t.hasOwnProperty("exp"))return null;let i=new Date(0);return i.setUTCSeconds(t.exp),i}isTokenExpired(e=this.tokenGetter(),t){return e instanceof Promise?e.then(i=>this._isTokenExpired(i,t)):this._isTokenExpired(e,t)}_isTokenExpired(e,t){if(!e||e==="")return!0;let i=this.getTokenExpirationDate(e);return t=t||0,i===null?!1:!(i.valueOf()>new Date().valueOf()+t*1e3)}getAuthScheme(e,t){return typeof e=="function"?e(t):e}}return o.\u0275fac=function(e){return new(e||o)(I(be))},o.\u0275prov=h({token:o,factory:o.\u0275fac}),o})();var w=class o{constructor(){}static get instance(){return this._instance||(this._instance=new o),this._instance}decode(n){return new te().decodeToken(n)}};var k=class{static initialize(){}static getDecodedToken(){let n=sessionStorage.getItem("token");if(n)return w.instance.decode(n)}};k.initialize();var T=class o{constructor(){}static get instance(){return this._instance||(this._instance=new o),this._instance}alert(n,e,t){alertify.alert(n,e,t)}confirm(n,e,t,i){n||(n=a.confirmMassageBoxTitle),t?i?alertify.confirm(n,e,t,i).set({labels:{ok:a.okMessageBoxLabel,cancel:a.cancelMessageBoxLabel},reverseButtons:!0,closable:!1}):alertify.confirm(n,e,t,()=>{}):alertify.confirm(n,e)}success(n=a.successNotifier){alertify.success(n)}message(n=a.messageNotifier){alertify.message(n)}notify(n=a.notifyNotifier){alertify.notify(n)}error(n=a.errorNotifier){alertify.error(n)}};var oe=class{constructor(){this.alertify=T.instance,this.spinner=b.instance,this.decodedToken=k.getDecodedToken()}};export{_e as a,Be as b,T as c,oe as d};
