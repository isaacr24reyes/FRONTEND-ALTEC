import{a as U}from"./chunk-FZMS2B7D.js";import{a as ie}from"./chunk-O6BAHGEK.js";import"./chunk-4QRD2FVP.js";import{a as fe}from"./chunk-E42FEA2W.js";import{c as Oe}from"./chunk-QUSHO67F.js";import{a as Me}from"./chunk-GUIBHJFR.js";import"./chunk-IHXC5BBL.js";import{O as Fe,a as oe,b as B,c as P,d as G,e as W,f as Se,g as ne,h as R,i as we,k as q,l as j,m as re,n as ae,o as ce,q as Ie,r as le,s as de,t as se}from"./chunk-AJCMZLG5.js";import{$a as w,Aa as s,Ca as ve,Cb as ee,Db as te,Ga as n,Ha as o,Ia as u,Ja as K,K as _e,Ka as Q,La as F,Na as _,O,Oa as m,P as xe,Qb as Ee,U as g,V as f,Za as X,_a as r,ab as v,cb as b,db as y,eb as E,gb as Pe,ha as k,ia as Ce,ib as be,ja as l,jb as L,ka as S,kb as z,mb as Z,w as Y,wa as x,xb as ye,y as J,yb as D,zb as T}from"./chunk-DGXXNF4P.js";import{a as N,b as A,g as ge}from"./chunk-ODN5LVDJ.js";var pe=ge(fe());var ze=c=>({"text-danger text-decoration-underline":c});function De(c,h){if(c&1&&(K(0),u(1,"img",12),Q()),c&2){let e=m(2);l(),s("src",e.product.foto,k)}}function Be(c,h){c&1&&(n(0,"div",13),r(1,"Este producto no tiene imagen."),o())}function Ge(c,h){if(c&1&&(n(0,"div")(1,"div",2)(2,"h4",3),r(3),o()(),n(4,"div",4)(5,"div",5),x(6,De,2,1,"ng-container",6)(7,Be,2,0,"ng-template",null,0,Z),o(),n(9,"div",7)(10,"ul",8)(11,"li",9),u(12,"i",10),n(13,"strong"),r(14,"Creado por:"),o(),r(15),o(),n(16,"li",9)(17,"strong"),r(18,"Categor\xEDa:"),o(),r(19),o(),n(20,"li",9)(21,"strong"),r(22,"C\xF3digo:"),o(),r(23),o(),n(24,"li",9)(25,"strong"),r(26,"PVP:"),o(),r(27),L(28,"currency"),o(),n(29,"li",9)(30,"strong"),r(31,"Precio mayorista:"),o(),r(32),L(33,"currency"),o(),n(34,"li",9)(35,"strong"),r(36,"Precio importaci\xF3n:"),o(),r(37),L(38,"currency"),o(),n(39,"li",9)(40,"strong",11),r(41,"Stock:"),o(),r(42),o()()()()()),c&2){let e=X(8),i=m();l(3),w(i.product.descripcion),l(3),s("ngIf",i.product.foto&&i.product.foto!=="NOT-IMAGE")("ngIfElse",e),l(9),v(" ",i.product.createdBy," "),l(4),v(" ",i.product.categoria,""),l(4),v(" ",i.product.codigo,""),l(4),v(" ",z(28,11,i.product.pvp),""),l(5),v(" ",z(33,13,i.product.precioMayorista),""),l(5),v(" ",z(38,15,i.product.precioImportacion),""),l(3),s("ngClass",be(17,ze,i.product.stock<=5)),l(2),v(" ",i.product.stock," ")}}var ke=(()=>{class c{static{this.\u0275fac=function(i){return new(i||c)}}static{this.\u0275cmp=O({type:c,selectors:[["app-extra-product-info"]],inputs:{product:"product"},decls:1,vars:1,consts:[["noImage",""],[4,"ngIf"],[1,"text-center","mb-4"],[1,"fw-bold"],[1,"row"],[1,"col-md-6","text-center"],[4,"ngIf","ngIfElse"],[1,"col-md-6"],[1,"list-group","list-group-flush"],[1,"list-group-item"],[1,"bi","bi-person-fill","me-2",2,"color","#0d6efd"],[3,"ngClass"],["alt","Producto",2,"max-width","100%","height","auto",3,"src"],[1,"text-muted"]],template:function(i,t){i&1&&x(0,Ge,43,19,"div",1),i&2&&s("ngIf",t.product)},dependencies:[ye,T,ee]})}}return c})();function Re(c,h){if(c&1&&(K(0),u(1,"img",62),Q()),c&2){let e=m().$implicit;l(),s("src",e.foto,k)}}function qe(c,h){c&1&&(n(0,"span"),r(1,"Producto no contiene imagen"),o())}function je(c,h){if(c&1){let e=F();n(0,"tr",57),_("click",function(){let t=g(e).$implicit,a=m(2);return f(a.openProductModal(t))}),n(1,"td",58),r(2),o(),n(3,"td",59),r(4),o(),n(5,"td",58),r(6),L(7,"currency"),o(),n(8,"td",60),x(9,Re,2,1,"ng-container",61)(10,qe,2,0,"ng-template",null,0,Z),o()()}if(c&2){let e=h.$implicit,i=X(11);l(2),w(e.codigo),l(2),w(e.descripcion),l(2),w(z(7,5,e.pvp)),l(3),s("ngIf",e.foto!=="NOT-IMAGE")("ngIfElse",i)}}function Ue(c,h){if(c&1){let e=F();n(0,"div")(1,"form",24),_("ngSubmit",function(){g(e);let t=m();return f(t.onSubmit())}),n(2,"div",25)(3,"h1"),r(4,"Consultar en bodega"),o()(),n(5,"div",26)(6,"div",27)(7,"div",28),u(8,"input",29),o()()(),n(9,"div",30)(10,"div",31)(11,"button",32),u(12,"i",33),r(13," Generar cat\xE1logo "),o()()(),n(14,"div",34)(15,"div",27)(16,"div",35)(17,"div",36)(18,"table",37)(19,"thead")(20,"tr")(21,"th",38),r(22,"C\xF3digo"),o(),n(23,"th",39),r(24,"Descripci\xF3n"),o(),n(25,"th",38),r(26,"PVP"),o(),n(27,"th",38),r(28,"Foto"),o()()(),n(29,"tbody"),x(30,je,12,7,"tr",40),o()()()()()(),u(31,"hr",41),n(32,"div",34)(33,"div",42)(34,"div",43)(35,"h4"),r(36),o()(),n(37,"div",44)(38,"button",45),_("click",function(){g(e);let t=m();return f(t.onPreviousPage())}),r(39,"Anterior"),o(),n(40,"button",46),_("click",function(){g(e);let t=m();return f(t.onNextPage())}),r(41,"Siguiente"),o()()()(),u(42,"hr",41),n(43,"div",47)(44,"span",48),r(45," Developed by "),n(46,"strong",49),r(47,"SwiFt\xA9"),o(),r(48," (2025). "),o()()(),n(49,"div",50)(50,"div",51)(51,"div",52)(52,"div",53)(53,"h5",54),r(54,"Informaci\xF3n detallada del producto"),o(),u(55,"button",55),o(),n(56,"div",8),u(57,"app-extra-product-info",56),o()()()()()}if(c&2){let e=m();l(),s("formGroup",e.formGroup),l(29),s("ngForOf",e.products),l(6),v("Total de productos: ",e.totalCount,""),l(2),s("disabled",e.currentPage===1),l(2),s("disabled",e.currentPage===e.totalPages),l(17),s("product",e.selectedProduct)}}var Ne=(()=>{class c{constructor(e,i){this.productService=e,this.fb=i,this.allProducts=[],this.products=[],this.totalCount=0,this.currentPage=1,this.totalPages=0,this.pageSize=5,this.isFirstLoad=!0,this.isLoading=!0,this.tipoInventario="estudiante",this.tipoCategoria="todo"}ngOnInit(){this.formGroup=this.fb.group({searchControl:[""]}),this.getAllProducts(),this.formGroup.get("searchControl").valueChanges.pipe(Y(300),J()).subscribe(()=>{this.currentPage=1,this.applyFilter()})}getAllProducts(){this.isFirstLoad&&(pe.default.Loading.standard("Cargando productos..."),this.isLoading=!0),this.productService.getProducts(1,1e3,"","descripcion","asc").subscribe({next:e=>{this.allProducts=(e.items||[]).map(i=>A(N({},i),{_normDesc:this.normalizeText(`${i.descripcion??""}`),_normCode:this.normalizeText(`${i.codigo??""}`)})),this.applyFilter(),this.isFirstLoad&&(pe.default.Loading.remove(),this.isLoading=!1,this.isFirstLoad=!1)},error:e=>{console.error("Error al obtener los productos",e),this.isFirstLoad&&(pe.default.Loading.remove(),this.isLoading=!1,this.isFirstLoad=!1)}})}generarInventario(){console.log("Generando inventario...")}applyFilter(){let e=this.formGroup.get("searchControl").value||"",i=this.tokenize(e),t=this.allProducts;i.length&&(t=this.allProducts.map(d=>{let C=d._normDesc,p=d._normCode,V=i.every(M=>this.textContainsToken(C,M)||this.textContainsToken(p,M))?this.scoreMatch(C,p,i):-1;return{p:d,score:V}}).filter(d=>d.score>=0).sort((d,C)=>C.score-d.score).map(d=>d.p)),this.totalCount=t.length,this.totalPages=Math.ceil(this.totalCount/this.pageSize)||1;let a=(this.currentPage-1)*this.pageSize;this.products=t.slice(a,a+this.pageSize)}onPreviousPage(){this.currentPage>1&&(this.currentPage--,this.applyFilter())}onNextPage(){this.currentPage<this.totalPages&&(this.currentPage++,this.applyFilter())}openProductModal(e){this.selectedProduct=e;let i=document.getElementById("productModal");i&&new bootstrap.Modal(i).show()}normalizeText(e){return(e||"").normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().replace(/\s+/g," ").trim()}tokenize(e){return this.normalizeText(e).match(/[a-z0-9]+/gi)?.map(t=>this.normalizeText(t))??[]}stem(e){return e.replace(/(es|s)$/i,"")}escapeRegExp(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}textContainsToken(e,i){if(!e||!i)return!1;let t=this.escapeRegExp(i),a=this.escapeRegExp(this.stem(i));return e.includes(i)||a&&e.includes(a)||new RegExp(`\\b${t}`,"i").test(e)||new RegExp(`${t}\\b`,"i").test(e)}scoreMatch(e,i,t){let a=0;for(let p of t){let H=this.textContainsToken(i,p),V=this.textContainsToken(e,p);H&&(a+=10),V&&(a+=4);let M=this.escapeRegExp(p);new RegExp(`\\b${M}\\b`).test(e)&&(a+=2),new RegExp(`\\b${M}\\b`).test(i)&&(a+=4),e.startsWith(p)&&(a+=2),i.startsWith(p)&&(a+=3)}let d=t.every(p=>this.textContainsToken(e,p)),C=t.every(p=>this.textContainsToken(i,p));return d&&(a+=5),C&&(a+=8),a}onSubmit(){}descargarPDF(){console.log("Descargando PDF para:",this.tipoInventario)}descargarExcel(){console.log("Descargando Excel para:",this.tipoInventario)}static{this.\u0275fac=function(i){return new(i||c)(S(U),S(le))}}static{this.\u0275cmp=O({type:c,selectors:[["app-inventario"]],decls:36,vars:3,consts:[["noImage",""],[4,"ngIf"],["id","inventarioModal","tabindex","-1","aria-labelledby","inventarioModalLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog","modal-dialog-centered"],[1,"modal-content","bg-dark","text-white"],[1,"modal-header","border-0"],["id","inventarioModalLabel",1,"modal-title","w-100"],["type","button","data-bs-dismiss","modal","aria-label","Cerrar",1,"btn-close","btn-close-white"],[1,"modal-body"],[1,"mb-4","text-start"],["for","tipoInventario",1,"form-label"],["id","tipoInventario",1,"form-select","bg-secondary","text-white",3,"ngModelChange","ngModel"],["value","estudiante"],["value","importador"],["value","admin"],["for","categoria",1,"form-label"],["id","categoria",1,"form-select","bg-secondary","text-white",3,"ngModelChange","ngModel"],["value","todo"],["value","compuertas"],["value","modulos"],[1,"mb-4","text-center"],[1,"d-grid","gap-2","col-8","mx-auto"],[1,"btn","btn-danger",3,"click"],[1,"btn","btn-primary",3,"click"],[1,"login-form",3,"ngSubmit","formGroup"],[1,"text-center"],[1,"container","mt-3"],[1,"row","justify-content-center"],[1,"col-12","col-md-8"],["type","search","placeholder","Buscar producto o c\xF3digo...","aria-label","Search","formControlName","searchControl",1,"form-control"],[1,"row","justify-content-center","mt-3"],[1,"col-12","col-md-8","text-end"],["type","button","data-bs-toggle","modal","data-bs-target","#inventarioModal",1,"btn","btn-success"],[1,"bi","bi-box-arrow-down"],[1,"container","mt-5"],[1,"col-12"],[1,"table-responsive"],[1,"table","table-bordered","text-center"],[2,"width","10%","background-color","#08274F","color","white","font-weight","bold"],[2,"width","40%","background-color","#08274F","color","white","font-weight","bold"],["style","cursor: pointer;",3,"click",4,"ngFor","ngForOf"],[1,"styled-line"],[1,"row","justify-content-between","align-items-center"],[1,"col-12","col-md-auto","mb-2","mb-md-0"],[1,"col-12","col-md-auto"],[1,"btn","btn-primary","me-2",3,"click","disabled"],[1,"btn","btn-primary",3,"click","disabled"],[1,"text-center","mt-5"],[1,"text-white","small-text"],[2,"color","#8B50FB"],["id","productModal","tabindex","-1","aria-labelledby","productModalLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog","modal-lg","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],["id","productModalLabel",1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Cerrar",1,"btn-close"],[3,"product"],[2,"cursor","pointer",3,"click"],[2,"vertical-align","middle"],[1,"text-break",2,"vertical-align","middle"],[2,"padding","0"],[4,"ngIf","ngIfElse"],["alt","Producto",1,"img-thumbnail",2,"max-width","200px",3,"src"]],template:function(i,t){i&1&&(x(0,Ue,58,6,"div",1),n(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5)(5,"h5",6),r(6,"\xBFC\xF3mo deseas descargar tu cat\xE1logo?"),o(),u(7,"button",7),o(),n(8,"div",8)(9,"div",9)(10,"label",10),r(11,"Cat\xE1logo para:"),o(),n(12,"select",11),E("ngModelChange",function(d){return y(t.tipoInventario,d)||(t.tipoInventario=d),d}),n(13,"option",12),r(14,"Estudiante"),o(),n(15,"option",13),r(16,"Importador"),o(),n(17,"option",14),r(18,"Admin"),o()()(),n(19,"div",9)(20,"label",15),r(21,"Mostrar:"),o(),n(22,"select",16),E("ngModelChange",function(d){return y(t.tipoCategoria,d)||(t.tipoCategoria=d),d}),n(23,"option",17),r(24,"Todo"),o(),n(25,"option",18),r(26,"Compuertas"),o(),n(27,"option",19),r(28,"M\xF3dulos"),o()()(),n(29,"p",20),r(30,"Selecciona el formato para generar tu cat\xE1logo."),o(),n(31,"div",21)(32,"button",22),_("click",function(){return t.descargarPDF()}),r(33,"\u{1F4C4} Descargar PDF"),o(),n(34,"button",23),_("click",function(){return t.descargarExcel()}),r(35,"\u{1F4CA} Descargar Excel"),o()()()()()()),i&2&&(s("ngIf",!t.isLoading),l(12),b("ngModel",t.tipoInventario),l(10),b("ngModel",t.tipoCategoria))},dependencies:[D,T,R,ae,ce,B,re,G,W,q,j,ne,ke,ee],styles:[".login-form[_ngcontent-%COMP%]{background:#18181c}.login-form[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{color:#fff;font-family:Acephimere,sans-serif;font-weight:1000;font-size:30px;padding-top:20px}.login-form[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#fff;font-family:Acephimere,sans-serif;font-weight:1000;font-size:15px}.login-form[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:#fff;font-family:Acephimere,sans-serif;font-weight:1000;font-size:18px;margin-right:10px}.login-form[_ngcontent-%COMP%]   .small-text[_ngcontent-%COMP%]{font-size:.75rem}.login-form[_ngcontent-%COMP%]   .styled-line[_ngcontent-%COMP%]{height:7px;background-color:#8b50fb;margin:20px auto;width:70%}@media (max-width: 576px){.login-form[_ngcontent-%COMP%]{padding:0 10px}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:.85rem}.btn[_ngcontent-%COMP%]{width:100%;margin-bottom:10px}.img-thumbnail[_ngcontent-%COMP%]{width:100px}}"]})}}return c})();var I=ge(fe());function $e(c,h){if(c&1&&(n(0,"span",27),r(1),o()),c&2){let e=m();l(),w(e.selectedCategory)}}function He(c,h){if(c&1){let e=F();n(0,"div",30),_("click",function(t){let a=g(e).$implicit,d=m(2);return f(d.selectCategory(a,t))}),r(1),o()}if(c&2){let e=h.$implicit,i=m(2);ve("active",e===i.selectedCategory),l(),v(" ",e," ")}}function Ye(c,h){if(c&1&&(n(0,"div",28),x(1,He,2,3,"div",29),o()),c&2){let e=m();l(),s("ngForOf",e.categories)}}function Je(c,h){c&1&&(n(0,"div",12)(1,"h2",5),r(2,"Precio de Importaci\xF3n:"),o(),u(3,"input",31),o())}function Ke(c,h){if(c&1&&(n(0,"div",10)(1,"div",4)(2,"h2",5),r(3,"Previsualizaci\xF3n:"),o(),u(4,"img",32),o()()),c&2){let e=m();l(4),s("src",e.imagePreview,k)}}var Ae=(()=>{class c{constructor(e,i,t){this.fb=e,this.productService=i,this.userSessionService=t,this.imagePreview=null,this.userName="",this.categories=["Audio y video","Baquelitas","Componentes Electr\xF3nicos","Compuertas e Integrados","Fuentes","Herramientas","Microcontroladores y Arduinos","Modulos y Sensores","Motores","Parlantes","Pilas y Baterias","Protoboards","Proyectos Y kits","Redes y Comunicaci\xF3n","Transformadores"],this.showCategoryList=!1,this.selectedCategory=null,this.formGroup=this.fb.group({productCategory:["",P.required],productCode:["",P.required],isImported:[!1],productStock:["",[P.required,P.pattern("^[0-9]*$")]],productPvp:["",[P.required,P.pattern("^[0-9]+([.,][0-9]{1,2})?$")]],productMp:["",[P.required,P.pattern("^[0-9]+([.,][0-9]{1,2})?$")]],productPi:["",[P.pattern("^[0-9]+([.,][0-9]{1,2})?$")]],productDescription:["",P.required],productImage:[null]}),this.formGroup.get("isImported")?.valueChanges.subscribe(a=>{let d=this.formGroup.get("productPi");a?d?.setValidators([P.required,P.pattern("^[0-9]+([.,][0-9]{1,2})?$")]):(d?.clearValidators(),d?.setValue("")),d?.updateValueAndValidity()}),this.userSessionService.getUserInfo().subscribe(a=>{a&&(this.userName=a.name)})}toggleCategoryList(e){this.showCategoryList=!this.showCategoryList}selectCategory(e,i){i.stopPropagation(),this.selectedCategory=e,this.formGroup.get("productCategory")?.setValue(e),this.showCategoryList=!1}closeOnOutsideClick(e){let i=e.target;!i.closest(".input-multiselect")&&!i.closest(".category-panel")&&(this.showCategoryList=!1)}onSubmit(){if(this.formGroup.invalid){I.default.Notify.failure("Por favor, completa todos los campos requeridos correctamente.");return}I.default.Confirm.show("Confirmaci\xF3n","\xBFEst\xE1s seguro de que deseas subir este producto?","S\xED","No",()=>{I.default.Loading.arrows("Subiendo producto...");let e=this.formGroup.value,i=this.selectedFile??null,t=new FormData;i?t.append("Foto",i,i.name):t.append("Foto","NOT-IMAGE");let a=e.productPvp.replace(".",","),d=e.productMp.replace(".",","),C="0";e.isImported&&e.productPi&&(C=e.productPi.replace(".",",")),t.append("Pvp",a),t.append("Descripcion",e.productDescription),t.append("Categoria",e.productCategory),t.append("IsImport",e.isImported),t.append("Stock",e.productStock),t.append("PrecioMayorista",d),t.append("Codigo",e.productCode),t.append("PrecioImportacion",C),t.append("CreatedBy",this.userName),this.productService.createProduct(t).subscribe(p=>{console.log("Producto creado:",p),setTimeout(()=>{I.default.Loading.remove(),I.default.Notify.success("\xA1Producto subido exitosamente!"),this.formGroup.reset(),this.selectedFile=null,this.imagePreview=null},2e3)},p=>{I.default.Loading.remove(),I.default.Notify.failure("Error al subir el producto.")})},()=>{I.default.Notify.info("Carga cancelada.")})}onFileSelected(e){let i=e.target;if(i?.files?.[0]){let t=i.files[0];if(!["image/jpeg","image/png"].includes(t.type)){I.default.Notify.failure("Solo se permiten archivos JPG y PNG"),i.value="";return}this.selectedFile=t;let d=new FileReader;d.onloadend=()=>{this.imagePreview=d.result},d.readAsDataURL(t)}}static{this.\u0275fac=function(i){return new(i||c)(S(Ie),S(U),S(Me))}}static{this.\u0275cmp=O({type:c,selectors:[["app-add-product"]],hostBindings:function(i,t){i&1&&_("click",function(d){return t.closeOnOutsideClick(d)},!1,Ce)},decls:64,vars:5,consts:[["autocomplete","off",1,"login-form",3,"ngSubmit","formGroup"],[1,"text-center"],[1,"container",2,"max-width","800px"],[1,"row"],[1,"col-12"],[1,"text-left"],[1,"input","input-multiselect",3,"click"],["class","chip",4,"ngIf"],[1,"bi","bi-caret-down-fill","caret"],["class","category-panel",4,"ngIf"],[1,"row","mt-3"],["type","text","id","productCode","formControlName","productCode","placeholder","C\xF3digo..","autocomplete","off",1,"form-control","gray-input"],[1,"col-6"],[1,"form-check","form-switch"],["type","checkbox","id","isImported","formControlName","isImported",1,"form-check-input"],["type","text","id","productStock","formControlName","productStock","placeholder","Stock..","appOnlyNumbers","","autocomplete","off",1,"form-control","gray-input"],["type","text","id","productPvp","formControlName","productPvp","placeholder","PVP..","appOnlyNumbers","","autocomplete","off",1,"form-control","gray-input"],["type","text","id","productMp","formControlName","productMp","placeholder","Precio Mayorista..","appOnlyNumbers","","autocomplete","off",1,"form-control","gray-input"],["class","col-6",4,"ngIf"],["type","text","id","productDescription","formControlName","productDescription","placeholder","Ingresa la descripci\xF3n del producto","autocomplete","off",1,"form-control","gray-input"],["type","file","id","productImage","formControlName","productImage","accept",".jpg, .jpeg, .png","autocomplete","off",1,"form-control",3,"change"],["class","row mt-3",4,"ngIf"],[1,"text-center","mt-3"],["type","submit",1,"btn","btn-primary"],[1,"text-center","mt-5"],[1,"text-white","small-text"],[2,"color","#8B50FB"],[1,"chip"],[1,"category-panel"],["class","category-option",3,"active","click",4,"ngFor","ngForOf"],[1,"category-option",3,"click"],["type","text","id","productPi","formControlName","productPi","placeholder","Precio Importaci\xF3n..","appOnlyNumbers","","autocomplete","off",1,"form-control","gray-input"],["alt","Vista previa",1,"img-fluid",2,"max-width","300px","max-height","300px",3,"src"]],template:function(i,t){if(i&1&&(n(0,"form",0),_("ngSubmit",function(){return t.onSubmit()}),n(1,"div",1)(2,"h1"),r(3,"Ingresar Productos"),o()(),n(4,"div",2)(5,"div",3)(6,"div",4)(7,"h2",5),r(8,"Categor\xEDa:"),o()(),n(9,"div",4)(10,"div",4)(11,"div",6),_("click",function(d){return t.toggleCategoryList(d)}),x(12,$e,2,1,"span",7),u(13,"i",8),o(),x(14,Ye,2,1,"div",9),o()()(),n(15,"div",10)(16,"div",4)(17,"h2",5),r(18,"C\xF3digo:"),o()(),n(19,"div",4),u(20,"input",11),o()(),n(21,"div",10)(22,"div",12)(23,"h2",5),r(24,"\xBFEs producto de importaci\xF3n?"),o(),n(25,"div",13),u(26,"input",14),o()()(),n(27,"div",10)(28,"div",12)(29,"h2",5),r(30,"Stock:"),o(),u(31,"input",15),o(),n(32,"div",12)(33,"h2",5),r(34,"PVP:"),o(),u(35,"input",16),o()(),n(36,"div",10)(37,"div",12)(38,"h2",5),r(39,"Precio Mayorista:"),o(),u(40,"input",17),o(),x(41,Je,4,0,"div",18),o(),n(42,"div",10)(43,"div",4)(44,"h2",5),r(45,"Descripci\xF3n:"),o()(),n(46,"div",4),u(47,"input",19),o()(),n(48,"div",10)(49,"div",4)(50,"h2",5),r(51,"Subir Foto:"),o()(),n(52,"div",12)(53,"input",20),_("change",function(d){return t.onFileSelected(d)}),o()()(),x(54,Ke,5,1,"div",21),o(),n(55,"div",22)(56,"button",23),r(57,"Subir"),o()(),n(58,"div",24)(59,"span",25),r(60," Developed by "),n(61,"strong",26),r(62,"SwiFt\xA9"),o(),r(63," (2025). "),o()()()),i&2){let a;s("formGroup",t.formGroup),l(12),s("ngIf",t.selectedCategory),l(2),s("ngIf",t.showCategoryList),l(27),s("ngIf",(a=t.formGroup.get("isImported"))==null?null:a.value),l(13),s("ngIf",t.imagePreview)}},dependencies:[D,T,R,B,oe,G,W,q,j],styles:[".login-form[_ngcontent-%COMP%]{background:#18181c}.login-form[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{color:#fff;font-family:Acephimere,sans-serif;font-weight:1000;font-size:35px;padding-top:20px}.login-form[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#fff;font-family:Acephimere,sans-serif;font-weight:1000;font-size:15px}.login-form[_ngcontent-%COMP%]   .small-text[_ngcontent-%COMP%]{font-size:.75rem}.login-form[_ngcontent-%COMP%]   .gray-input[_ngcontent-%COMP%]{background-color:#18181c;color:#fff}.login-form[_ngcontent-%COMP%]   .gray-input[_ngcontent-%COMP%]::placeholder{color:#7b7979!important}.login-form[_ngcontent-%COMP%]   .gray-input-select[_ngcontent-%COMP%]{background-color:#18181c;color:#fff!important}.login-form[_ngcontent-%COMP%]   .gray-input-select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{color:#fff!important;background-color:#18181c}.login-form[_ngcontent-%COMP%]   .input-multiselect[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;background:#18181c;border:1px solid rgba(255,255,255,.12);border-radius:6px;padding:.6rem .8rem;color:#e6f1f6;cursor:pointer;position:relative}.login-form[_ngcontent-%COMP%]   .input-multiselect[_ngcontent-%COMP%]   .chip[_ngcontent-%COMP%]{color:#e6dafe;font-size:1.1rem;line-height:1}.login-form[_ngcontent-%COMP%]   .input-multiselect[_ngcontent-%COMP%]   .placeholder[_ngcontent-%COMP%]{color:#18181c;cursor:pointer}.login-form[_ngcontent-%COMP%]   .input-multiselect[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{margin-left:auto;color:#9aa2ad;font-size:.9rem}.login-form[_ngcontent-%COMP%]   .category-panel[_ngcontent-%COMP%]{position:absolute;z-index:1000;width:100%;max-width:770px;background:#18181c;border:1px solid rgba(255,255,255,.12);border-radius:6px;margin-top:.35rem;padding:.25rem 0;max-height:288px;overflow-y:auto;box-shadow:0 10px 24px #00000059}.login-form[_ngcontent-%COMP%]   .category-option[_ngcontent-%COMP%]{padding:.65rem .9rem;color:#e6f1f6;cursor:pointer}.login-form[_ngcontent-%COMP%]   .category-option[_ngcontent-%COMP%]:hover{background:#22232b}.login-form[_ngcontent-%COMP%]   .category-option.active[_ngcontent-%COMP%]{background:#2b2740;border-left:3px solid #8B50FB}.login-form[_ngcontent-%COMP%]   .form-check-input[_ngcontent-%COMP%]{width:2.5em;height:1.5em}"]})}}return c})();var $=ge(fe());function Qe(c,h){if(c&1){let e=F();n(0,"div",22)(1,"div",23),u(2,"img",24),n(3,"div",25)(4,"h6",26),r(5),o(),n(6,"button",27),_("click",function(){let t=g(e).$implicit,a=m(2);return f(a.openModal(t))}),r(7,"Editar"),o()()()()}if(c&2){let e=h.$implicit;l(2),s("src",e.foto,k),l(3),w(e.descripcion)}}function Xe(c,h){if(c&1&&(n(0,"option",49),r(1),o()),c&2){let e=m(3);s("value",e.categoriaActual),l(),v(" ",e.categoriaActual," Otros ")}}function Ze(c,h){if(c&1&&(n(0,"option",49),r(1),o()),c&2){let e=h.$implicit;s("value",e),l(),v(" ",e," ")}}function et(c,h){if(c&1){let e=F();n(0,"div",28)(1,"form")(2,"div",29)(3,"label",30),r(4,"Categor\xEDa"),o(),n(5,"select",31),E("ngModelChange",function(t){g(e);let a=m(2);return y(a.selectedProduct.categoria,t)||(a.selectedProduct.categoria=t),f(t)}),x(6,Xe,2,2,"option",32)(7,Ze,2,2,"option",33),o()(),n(8,"div",29)(9,"label",34),r(10,"C\xF3digo"),o(),n(11,"input",35),E("ngModelChange",function(t){g(e);let a=m(2);return y(a.selectedProduct.codigo,t)||(a.selectedProduct.codigo=t),f(t)}),o()(),n(12,"div",36)(13,"input",37),E("ngModelChange",function(t){g(e);let a=m(2);return y(a.selectedProduct.isImport,t)||(a.selectedProduct.isImport=t),f(t)}),o(),n(14,"label",38),r(15," \xBFEs importado? "),o()(),n(16,"div",29)(17,"label",34),r(18,"Descripci\xF3n"),o(),n(19,"input",39),E("ngModelChange",function(t){g(e);let a=m(2);return y(a.selectedProduct.descripcion,t)||(a.selectedProduct.descripcion=t),f(t)}),o()(),n(20,"div",40)(21,"div",41)(22,"label",34),r(23,"Stock"),o(),n(24,"input",42),E("ngModelChange",function(t){g(e);let a=m(2);return y(a.selectedProduct.stock,t)||(a.selectedProduct.stock=t),f(t)}),o()(),n(25,"div",41)(26,"label",34),r(27,"PVP"),o(),n(28,"input",43),E("ngModelChange",function(t){g(e);let a=m(2);return y(a.selectedProduct.pvp,t)||(a.selectedProduct.pvp=t),f(t)}),o()()(),n(29,"div",40)(30,"div",41)(31,"label",34),r(32,"Precio Mayorista"),o(),n(33,"input",44),E("ngModelChange",function(t){g(e);let a=m(2);return y(a.selectedProduct.precioMayorista,t)||(a.selectedProduct.precioMayorista=t),f(t)}),o()(),n(34,"div",41)(35,"label",34),r(36,"Precio Importaci\xF3n"),o(),n(37,"input",45),E("ngModelChange",function(t){g(e);let a=m(2);return y(a.selectedProduct.precioImportacion,t)||(a.selectedProduct.precioImportacion=t),f(t)}),o()()(),n(38,"div",29)(39,"label",34),r(40,"Actualizar Foto"),o(),n(41,"input",46),_("change",function(t){g(e);let a=m(2);return f(a.onFileSelected(t))}),o()(),n(42,"div",47)(43,"button",48),_("click",function(){g(e);let t=m(2);return f(t.guardarEdicion())}),r(44,"Guardar Cambios"),o()()()()}if(c&2){let e=m(2);l(5),b("ngModel",e.selectedProduct.categoria),l(),s("ngIf",!e.categoriasValidas.includes(e.categoriaActual)),l(),s("ngForOf",e.categoriasValidas),l(4),b("ngModel",e.selectedProduct.codigo),l(2),b("ngModel",e.selectedProduct.isImport),l(6),b("ngModel",e.selectedProduct.descripcion),l(5),b("ngModel",e.selectedProduct.stock),l(4),b("ngModel",e.selectedProduct.pvp),l(5),b("ngModel",e.selectedProduct.precioMayorista),l(4),b("ngModel",e.selectedProduct.precioImportacion)}}function tt(c,h){if(c&1){let e=F();n(0,"div")(1,"form",1),_("ngSubmit",function(){g(e);let t=m();return f(t.onSubmit())}),n(2,"div",2)(3,"h1"),r(4,"Editar Productos"),o()(),n(5,"div",3)(6,"div",4)(7,"form",5),u(8,"input",6),o()()()(),n(9,"div",7)(10,"div",8),x(11,Qe,8,2,"div",9),o()(),n(12,"div",10)(13,"div",11)(14,"div",12)(15,"div",13)(16,"h5",14),r(17,"Editar Producto"),o(),u(18,"button",15),o(),x(19,et,45,10,"div",16),o()()(),u(20,"hr",17),n(21,"div",18)(22,"p",19),r(23),o(),n(24,"div")(25,"button",20),_("click",function(){g(e);let t=m();return f(t.onPreviousPage())}),r(26,"Anterior"),o(),n(27,"button",21),_("click",function(){g(e);let t=m();return f(t.onNextPage())}),r(28,"Siguiente"),o()()()()}if(c&2){let e=m();l(),s("formGroup",e.formGroup),l(6),s("formGroup",e.formGroup),l(4),s("ngForOf",e.products),l(8),s("ngIf",e.selectedProduct),l(4),v("Total de productos: ",e.totalCount,""),l(2),s("disabled",e.currentPage===1),l(2),s("disabled",e.currentPage===e.totalPages)}}var ue=(()=>{class c{constructor(e,i){this.productService=e,this.fb=i,this.allProducts=[],this.filteredProducts=[],this.products=[],this.currentPage=1,this.pageSize=25,this.totalCount=0,this.totalPages=0,this.categoriasValidas=["Audio y video","Baquelitas","Compuertas e Integrados","Componentes Electr\xF3nicos","Fuentes","Herramientas","Microcontroladores y Arduinos","Modulos y Sensores","Motores","Parlantes","Pilas y Baterias","Proyectos Y kits","Protoboards","Redes y Comunicaci\xF3n","Transformadores"],this.categoriaActual="",this.isFirstLoad=!0,this.isLoading=!0}ngOnInit(){this.selectedProduct&&(this.categoriaActual=this.selectedProduct.categoria||""),this.formGroup=this.fb.group({searchControl:[""]}),this.getProducts(),this.formGroup.get("searchControl")?.valueChanges.pipe(Y(300),J()).subscribe(()=>{this.currentPage=1,this.getProducts()})}getProducts(){this.allProducts.length?this.applyFilter():(this.isFirstLoad&&($.default.Loading.standard("Cargando productos..."),this.isLoading=!0),this.productService.getProducts(1,1e3,"").subscribe({next:e=>{let i=e?.items??[];this.allProducts=i.map(t=>A(N({},t),{_normDesc:this.normalizeText(`${t.descripcion??""}`),_normCode:this.normalizeText(`${t.codigo??""}`)})),this.applyFilter(),this.isFirstLoad&&($.default.Loading.remove(),this.isLoading=!1,this.isFirstLoad=!1)},error:e=>{console.error("Error al obtener productos:",e),this.isFirstLoad&&($.default.Loading.remove(),this.isLoading=!1,this.isFirstLoad=!1)}}))}applyFilter(){let e=this.formGroup.get("searchControl")?.value||"",i=this.tokenize(e),t=this.allProducts;i.length&&(t=this.allProducts.map(d=>{let C=d._normDesc,p=d._normCode,V=i.every(M=>this.textContainsToken(C,M)||this.textContainsToken(p,M))?this.scoreMatch(C,p,i):-1;return{p:d,score:V}}).filter(d=>d.score>=0).sort((d,C)=>C.score-d.score).map(d=>d.p)),this.filteredProducts=t,this.totalCount=t.length,this.totalPages=Math.ceil(this.totalCount/this.pageSize)||1;let a=(this.currentPage-1)*this.pageSize;this.products=t.slice(a,a+this.pageSize)}onPreviousPage(){this.currentPage>1&&(this.currentPage--,this.applyFilter())}onNextPage(){this.currentPage<this.totalPages&&(this.currentPage++,this.applyFilter())}openModal(e){this.selectedProduct=A(N({},e),{isImport:this.convertToBoolean(e.isImport)});let i=document.getElementById("productModal");i&&new bootstrap.Modal(i).show()}convertToBoolean(e){return typeof e=="boolean"?e:typeof e=="number"?e===1:typeof e=="string"?e.toLowerCase()==="true"||e==="1":!1}guardarEdicion(){this.selectedProduct&&this.productService.updateProduct(this.selectedProduct.id,this.selectedProduct).subscribe(e=>{let i=this.allProducts.findIndex(t=>t.id===e.id);i!==-1&&(this.allProducts[i]=A(N({},e),{_normDesc:this.normalizeText(`${e.descripcion??""}`),_normCode:this.normalizeText(`${e.codigo??""}`)})),this.applyFilter(),this.closeModal(),$.default.Report.success("Producto actualizado","El producto ha sido actualizado correctamente.","Aceptar")},e=>{console.error("Error al actualizar el producto",e),$.default.Report.failure("Error","Hubo un problema al actualizar el producto.","Cerrar")})}closeModal(){let e=document.getElementById("productModal");e&&bootstrap.Modal.getInstance(e)?.hide()}onSubmit(){this.currentPage=1,this.applyFilter()}onFileSelected(e){let i=e.target.files[0];i&&this.selectedProduct&&(this.selectedProduct.archivo=i)}normalizeText(e){return(e||"").normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().replace(/\s+/g," ").trim()}tokenize(e){return this.normalizeText(e).match(/[a-z0-9]+/gi)?.map(t=>this.normalizeText(t))??[]}stem(e){return e.replace(/(es|s)$/i,"")}escapeRegExp(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}textContainsToken(e,i){if(!e||!i)return!1;let t=this.escapeRegExp(i),a=this.escapeRegExp(this.stem(i));return e.includes(i)||a&&e.includes(a)||new RegExp(`\\b${t}`,"i").test(e)||new RegExp(`${t}\\b`,"i").test(e)}scoreMatch(e,i,t){let a=0;for(let p of t){let H=this.textContainsToken(i,p),V=this.textContainsToken(e,p);H&&(a+=10),V&&(a+=4);let M=this.escapeRegExp(p);new RegExp(`\\b${M}\\b`).test(e)&&(a+=2),new RegExp(`\\b${M}\\b`).test(i)&&(a+=4),e.startsWith(p)&&(a+=2),i.startsWith(p)&&(a+=3)}let d=t.every(p=>this.textContainsToken(e,p)),C=t.every(p=>this.textContainsToken(i,p));return d&&(a+=5),C&&(a+=8),a}static{this.\u0275fac=function(i){return new(i||c)(S(U),S(le))}}static{this.\u0275cmp=O({type:c,selectors:[["app-edit-product"]],standalone:!0,features:[Pe],decls:1,vars:1,consts:[[4,"ngIf"],[1,"product-quote-form",3,"ngSubmit","formGroup"],[1,"text-center"],[1,"container","d-flex","justify-content-center","mt-3"],[1,"d-flex",2,"width","70%","justify-content","center"],[1,"w-100",3,"formGroup"],["type","search","placeholder","Buscar producto...","aria-label","Search","formControlName","searchControl",1,"form-control","me-2"],[1,"container","mt-4"],[1,"row","row-cols-1","row-cols-sm-2","row-cols-md-3","row-cols-lg-4","row-cols-xl-5","g-4"],["class","col",4,"ngFor","ngForOf"],["id","productModal","tabindex","-1","aria-labelledby","productModalLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog","modal-dialog-centered","modal-lg"],[1,"modal-content","bg-dark","text-white"],[1,"modal-header"],["id","productModalLabel",1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Cerrar",1,"btn-close","btn-close-white"],["class","modal-body",4,"ngIf"],[1,"mt-4","border-top","border-primary","border-2","opacity-25"],[1,"d-flex","justify-content-between","align-items-center","mt-3","px-2"],[1,"mb-0","fw-bold","text-white"],[1,"btn","btn-primary","me-2",3,"click","disabled"],[1,"btn","btn-primary",3,"click","disabled"],[1,"col"],[1,"card","h-100","text-white","bg-dark","border-light"],["alt","Imagen",1,"card-img-top",3,"src"],[1,"card-body","text-center"],[1,"card-title"],[1,"btn","btn-primary","btn-sm","w-100",3,"click"],[1,"modal-body"],[1,"mb-3"],["for","categoria",1,"lbl"],["id","categoria","name","categoria",1,"select",3,"ngModelChange","ngModel"],[3,"value",4,"ngIf"],[3,"value",4,"ngFor","ngForOf"],[1,"form-label"],["type","text","name","codigo",1,"form-control",3,"ngModelChange","ngModel"],[1,"form-check","form-switch","mb-3"],["type","checkbox","id","isimportCheck","name","isImport",1,"form-check-input",3,"ngModelChange","ngModel"],["for","isimportCheck",1,"form-check-label"],["type","text","name","descripcion",1,"form-control",3,"ngModelChange","ngModel"],[1,"mb-3","d-flex","gap-2"],[1,"flex-fill"],["type","number","name","stock",1,"form-control",3,"ngModelChange","ngModel"],["type","number","name","pvp",1,"form-control",3,"ngModelChange","ngModel"],["type","number","name","precioMayorista",1,"form-control",3,"ngModelChange","ngModel"],["type","number","name","precioImportacion",1,"form-control",3,"ngModelChange","ngModel"],["type","file",1,"form-control",3,"change"],[1,"text-end"],["type","button",1,"btn","btn-success",3,"click"],[3,"value"]],template:function(i,t){i&1&&x(0,tt,29,7,"div",0),i&2&&s("ngIf",!t.isLoading)},dependencies:[se,R,ae,ce,B,we,oe,re,G,W,q,j,de,ne,Se,te,D,T],styles:[".product-quote-form[_ngcontent-%COMP%]{background:#18181c}.product-quote-form[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{color:#fff;font-family:Acephimere,sans-serif;font-weight:1000;font-size:30px;padding-top:20px}.product-quote-form[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#fff;font-family:Acephimere,sans-serif;font-weight:1000;font-size:15px}.product-quote-form[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%], .product-quote-form[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{color:#fff;font-family:Acephimere,sans-serif;font-weight:1000;font-size:18px;margin-right:10px}.product-quote-form[_ngcontent-%COMP%]   .small-text[_ngcontent-%COMP%]{font-size:.75rem}.product-quote-form[_ngcontent-%COMP%]   .styled-line[_ngcontent-%COMP%]{height:7px;background-color:#8b50fb;margin:20px auto;width:70%}.product-quote-form[_ngcontent-%COMP%]   .eliminar-columna[_ngcontent-%COMP%]{display:none}.card-img-top[_ngcontent-%COMP%]{height:140px;object-fit:cover;border-bottom:1px solid #444}[_nghost-%COMP%]{display:block;background-color:#18181c;min-height:100vh;padding-bottom:2rem}"]})}}return c})();var Le=[{path:"inventario",component:Ne,canActivate:[ie]},{path:"add-product",component:Ae,canActivate:[ie]},{path:"edit-product",component:ue,canActivate:[ie]}];var kt=(()=>{class c{static{this.\u0275fac=function(i){return new(i||c)}}static{this.\u0275mod=xe({type:c})}static{this.\u0275inj=_e({imports:[te,Fe,Oe,Ee.forChild(Le),se,de,ue]})}}return c})();export{kt as WarehouseModule};
